{{ $cssOptions := cond (.Site.IsServer) (dict "enableSourceMap" false) (dict "outputStyle" "compressed") }}

{{ $stylesCSS := resources.Get "assets/scss/mystyles.scss" | toCSS }}
{{ $mobileCSS := resources.Get "assets/scss/mobile.scss" | toCSS }}
{{ $darkCSS := resources.Get "assets/scss/dark.scss" | toCSS}}

{{ $themeStylesCSS := resources.Get "themes/sp-minimal/static/css/styles.css" }}
{{ $minimalStylesCSS := resources.Get "themes/sp-minimal/static/css/sp-minimal.css" }}
{{ $minimalSimpleCSS := resources.Get "themes/sp-minimal/static/css/sp-minimal-simple.css" }}

{{ $combined := cond (eq .Site.Params.themeStyle "simple") 
  (slice $themeStylesCSS $minimalStylesCSS $minimalSimpleCSS $stylesCSS $mobileCSS $darkCSS) 
  (slice $themeStylesCSS $minimalStylesCSS $stylesCSS $mobileCSS $darkCSS) }}

{{ if .Site.IsServer }}
{{ range $combined }}
    <link rel="stylesheet" defer href="{{ .Permalink }}">
{{ end }}
{{ else }}
  {{ $styles := $combined | minify}}
  <link rel="stylesheet" defer href="{{ $styles.Permalink }}">
{{ end }}