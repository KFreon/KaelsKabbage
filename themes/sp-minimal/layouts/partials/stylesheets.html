{{ $cssOptions := cond (.Site.IsServer) (dict "enableSourceMap" false) (dict "outputStyle" "compressed") }}

{{ $stylesCSS := resources.Get "assets/scss/mystyles.scss" | toCSS }}
{{ $mobileCSS := resources.Get "assets/scss/mobile.scss" | toCSS }}
{{ $darkCSS := resources.Get "assets/scss/dark.scss" | toCSS}}
{{ $code := resources.Get "assets/scss/code.scss" | toCSS}}

{{ $themeStylesCSS := resources.Get "themes/sp-minimal/static/css/styles.css" }}
{{ $minimalStylesCSS := resources.Get "themes/sp-minimal/static/css/sp-minimal.css" }}
{{ $minimalSimpleCSS := resources.Get "themes/sp-minimal/static/css/sp-minimal-simple.css" }}

{{ $firstSheets := slice $themeStylesCSS $minimalStylesCSS $minimalSimpleCSS $stylesCSS $code }}





<!-- These need to be last -->
{{ $lastSheets := slice $mobileCSS $darkCSS }}
{{ $combined := union $firstSheets $lastSheets }}

{{ if .Site.IsServer }}
{{ range $combined }}
    <link rel="stylesheet" defer href="{{ .Permalink }}">
{{ end }}
{{ else }}
  {{ $styles := $combined | resources.Concat "css/stupid.css" | minify}} <!-- Hugo types are dumb (cos they're hidden) and I need to coerce it's type to the correct one -->
  <link rel="stylesheet" defer href="{{ $styles.Permalink }}">
{{ end }}